<project name="MacrodefTest" default="main" basedir=".">

    <target name="main" depends="echo, echo2, zip, zip2" />

    <macrodef name="echotest">
        <text name="text"/>
        <sequential>
            <echo>[Echo test] @{text}</echo>
        </sequential>
    </macrodef>

    <target name="echo">
        <echotest>
            Hello world
        </echotest>
    </target>

    <macrodef name="prefixecho">
        <attribute name="prefix" default=""/>
        <attribute name="postfix" default="."/>
        <text name="thetext"/>
        <sequential>
            <echo>[@{prefix}] @{thetext}@{postfix}</echo>
        </sequential>
    </macrodef>

    <target name="echo2">
        <prefixecho prefix="This is a test" postfix="!">
            Let's do this!
        </prefixecho>
    </target>

     <macrodef name="zipmacro">
        <element name="zfs"/>
        <sequential>
            <zip destfile="result.zip">
                <zfs/>
            </zip>
            <zip destfile="result2.zip">
                <zfs/>
            </zip>
        </sequential>
    </macrodef>

    <target name="zip">
        <zipmacro>
            <zfs>
                <zipfileset dir="src" prefix="src"/>
                <zipfileset dir="target" prefix="target"/>
            </zfs>
        </zipmacro>
    </target>

    <macrodef name="zipmacro2">
        <element name="zfs2" implicit="yes"/>
        <sequential>
            <zip destfile="result3.zip">
                <zfs2/>
            </zip>
        </sequential>
    </macrodef>

    <target name="zip2">
        <zipmacro2>
            <zipfileset dir="src" prefix="src"/>
            <zipfileset dir="target" prefix="target"/>
        </zipmacro2>
    </target>
</project>
